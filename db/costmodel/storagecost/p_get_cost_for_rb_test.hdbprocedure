PROCEDURE "SAP_TM_TRP"."sap.tm.trp.db.costmodel.storagecost::p_get_cost_for_rb_test"(
        IN RESOURCE_CATEGORY VARCHAR(20),
		IN COST_MODEL_ID INTEGER,
		OUT SD_RESULT "sap.tm.trp.db.costmodel.storagecost::tt_sd_result",      
        OUT STORAGE_COST DOUBLE
	)
	LANGUAGE SQLSCRIPT
	SQL SECURITY INVOKER
	DEFAULT SCHEMA "SAP_TM_TRP"
AS
BEGIN

	DECLARE INIT_TIME TIMESTAMP DEFAULT TO_TIMESTAMP('2019-08-01 00:00.000','YYYY-MM-DD HH:SS.FF3');
	DECLARE OCCURRED_TIME TIMESTAMP DEFAULT TO_TIMESTAMP('2019-08-14 00:00.000','YYYY-MM-DD HH:SS.FF3');
	DECLARE I INTEGER;
	  
	LOCATION_RESOURCE_LIST = SELECT 'CNNGBDYUA' AS LOCATION, '20ST' AS RESOURCE_TYPE FROM DUMMY
	UNION SELECT 'CNDLCDDAS' AS LOCATION, '10ST' AS RESOURCE_TYPE FROM DUMMY;
	 		 
	/*LOCATION_RESOURCE_LIST = SELECT 'CNSHA' AS LOCATION, '20ST' AS RESOURCE_TYPE FROM DUMMY
	 		 UNION SELECT 'CNYTNDYCT' AS LOCATION, '20ST' AS RESOURCE_TYPE FROM DUMMY
	 		 UNION SELECT 'CNNGBDYUA' AS LOCATION, '20ST' AS RESOURCE_TYPE FROM DUMMY
	 		 UNION SELECT 'CNDLCDDAS' AS LOCATION, '20ST' AS RESOURCE_TYPE FROM DUMMY
	 		 UNION SELECT 'CNSHA' AS LOCATION, '10ST' AS RESOURCE_TYPE FROM DUMMY
	 		 UNION SELECT 'CNYTNDYCT' AS LOCATION, '10ST' AS RESOURCE_TYPE FROM DUMMY
	 		 UNION SELECT 'CNNGBDYUA' AS LOCATION, '10ST' AS RESOURCE_TYPE FROM DUMMY
	 		 UNION SELECT 'CNDLCDDAS' AS LOCATION, '10ST' AS RESOURCE_TYPE FROM DUMMY;*/
	
	DEMO_TIME = SELECT 80  AS STOCK, 100 AS SUPPLY, 30 AS DEMAND, ADD_DAYS(:INIT_TIME,0) AS START_TIME, ADD_DAYS(:INIT_TIME,1) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 170 AS SUPPLY, 0 AS DEMAND, ADD_DAYS(:INIT_TIME,1) AS START_TIME, ADD_DAYS(:INIT_TIME,2) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 270 AS SUPPLY, 130 AS DEMAND, ADD_DAYS(:INIT_TIME,2) AS START_TIME, ADD_DAYS(:INIT_TIME,3) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 250 AS SUPPLY, 220 AS DEMAND, ADD_DAYS(:INIT_TIME,3) AS START_TIME, ADD_DAYS(:INIT_TIME,4) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 40 AS SUPPLY, 0 AS DEMAND, ADD_DAYS(:INIT_TIME,4) AS START_TIME, ADD_DAYS(:INIT_TIME,5) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 50 AS SUPPLY, 120 AS DEMAND, ADD_DAYS(:INIT_TIME,5) AS START_TIME, ADD_DAYS(:INIT_TIME,6) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 250 AS SUPPLY, 80 AS DEMAND, ADD_DAYS(:INIT_TIME,6) AS START_TIME, ADD_DAYS(:INIT_TIME,7) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 260 AS SUPPLY, 20 AS DEMAND, ADD_DAYS(:INIT_TIME,7) AS START_TIME, ADD_DAYS(:INIT_TIME,7*2) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 300 AS SUPPLY, 10 AS DEMAND, ADD_DAYS(:INIT_TIME,7*2) AS START_TIME, ADD_DAYS(:INIT_TIME,7*3) AS END_TIME FROM DUMMY
		  UNION SELECT 0  AS STOCK, 300 AS SUPPLY, 0 AS DEMAND, ADD_DAYS(:INIT_TIME,7*3) AS START_TIME, ADD_DAYS(:INIT_TIME,7*4) AS END_TIME FROM DUMMY;
	
	SD_RESULT = SELECT 
	T1.LOCATION,
	T1.RESOURCE_TYPE,
	T2.START_TIME,
	T2.END_TIME,
	T2.SUPPLY,
	T2.DEMAND,
	T2.STOCK
	FROM :LOCATION_RESOURCE_LIST T1, :DEMO_TIME T2
	ORDER BY T1.LOCATION,T1.RESOURCE_TYPE,T2.START_TIME;

	CALL "sap.tm.trp.db.costmodel.storagecost::p_get_cost_for_rb" (null,:RESOURCE_CATEGORY,:COST_MODEL_ID,:SD_RESULT,STORAGE_COST);

END;
