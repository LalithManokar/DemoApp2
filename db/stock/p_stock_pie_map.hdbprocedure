PROCEDURE "SAP_TM_TRP"."sap.tm.trp.db.stock::p_stock_pie_map" (
    IN EQUIPMENT_FILTER_ID BIGINT,
    IN LOCATION_FILTER_ID BIGINT,
    IN ATTRIBUTE_GROUP_ID BIGINT,
    IN NODE_ID_LIST "sap.tm.trp.db.filter::tt_attribute_group_dynamic_item_node_list",
    IN XMIN DOUBLE,
    IN XMAX DOUBLE,
    IN YMIN DOUBLE,
    IN YMAX DOUBLE,
    IN HIERARCHY_LEVEL INT,
    OUT out_stock_pie_map "sap.tm.trp.db.stock::tt_stock_pie_map_info",
    OUT TOO_MUCH_LOCATION_FLAG SMALLINT,
    OUT GIS_TYPE VARCHAR(10),
    OUT OUT_LOCATIONS_XPOS_YPOS_INVALID  "sap.tm.trp.db.pipeline::tt_location_info_list" 
    ) 
    LANGUAGE SQLSCRIPT
    SQL SECURITY INVOKER 
    DEFAULT SCHEMA "SAP_TM_TRP"
AS
GEO_FLAG INT;
EQUIP_FLAG INT;
IN_POLYGON CLOB;
SQL_STR CLOB;
BEGIN
 


  DECLARE NO_ATTRIBUTE_GROUP BIGINT := -1;
 IF ATTRIBUTE_GROUP_ID >:NO_ATTRIBUTE_GROUP THEN
  CALL "sap.tm.trp.db.stock::p_stock_pie_map_with_attributegroup" (:EQUIPMENT_FILTER_ID,:LOCATION_FILTER_ID,:ATTRIBUTE_GROUP_ID,:NODE_ID_LIST,:XMIN,:XMAX,:YMIN,:YMAX,:HIERARCHY_LEVEL,out_stock_pie_map,TOO_MUCH_LOCATION_FLAG,GIS_TYPE,OUT_LOCATIONS_XPOS_YPOS_INVALID); 
ELSE
   CALL "sap.tm.trp.db.stock::p_stock_pie_map_without_attributegroup" (:EQUIPMENT_FILTER_ID,:LOCATION_FILTER_ID,:XMIN,:XMAX,:YMIN,:YMAX,:HIERARCHY_LEVEL,out_stock_pie_map,TOO_MUCH_LOCATION_FLAG,GIS_TYPE,OUT_LOCATIONS_XPOS_YPOS_INVALID);
 END IF;

END;




