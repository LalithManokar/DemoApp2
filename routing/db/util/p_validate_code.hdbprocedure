PROCEDURE "SAP_TM_ROUTING"."sap.tm.trp.routing.db.util::p_validate_code" ( 
    IN code VARCHAR(50),
    OUT return_code TINYINT,
	OUT message "sap.tm.trp.routing.db.common::tt_message"
)
   LANGUAGE SQLSCRIPT
   SQL SECURITY INVOKER
   DEFAULT SCHEMA "SAP_TM_ROUTING"
   READS SQL DATA AS
BEGIN
    DECLARE temp VARCHAR(50);
    
     -- Dataset code is mandatory
	msg_param = SELECT 0 AS PLACEHOLDER, '' AS VALUE FROM DUMMY WHERE 1 <> 1;
	IF :code = '' THEN
	    select 1 into return_code from dummy;
	    call "sap.tm.trp.routing.db.common::p_get_text"
        ('MSG_DATASET_CODE_MANDATORY', :msg_param, 'E', :message);
        return;
	END IF;
	
	-- Just aphabet, number and _ is allowed in the code
    SELECT SUBSTR_REGEXPR('[[:alpha:]_][[:alnum:]_]*' IN :code) INTO temp FROM DUMMY;
    
    IF :temp <> :code THEN
        msg_param = SELECT 0 AS PLACEHOLDER, :code AS VALUE FROM DUMMY;
	    select 1 into return_code from dummy;
	    call "sap.tm.trp.routing.db.common::p_get_text"
        ('MSG_CODE_INVALID', :msg_param, 'E', :message);
        return;
	END IF;
	
	return_code = 0;
    
END