PROCEDURE "SAP_TM_ROUTING_TEST"."sap.tm.trp.routing.tests.db::p_query_capacity_by_trip_segment_stub" (
    IN dataset_code NVARCHAR(50),
    IN trip_segment TABLE (trip_id NVARCHAR(100), path_id BIGINT, from_sequence INTEGER, to_sequence INTEGER),
    OUT capacity TABLE(trip_id NVARCHAR(100), from_sequence INTEGER, to_sequence INTEGER, capacity DECIMAL(20, 4))
)
   LANGUAGE SQLSCRIPT
   SQL SECURITY INVOKER
   DEFAULT SCHEMA SAP_TM_ROUTING_TEST
   READS SQL DATA AS
BEGIN
   /*************************************
       Write your procedure logic 
   *************************************/
   capacity = 
   SELECT A.trip_id, A.from_sequence, A.to_sequence, B.capacity
   FROM :trip_segment AS A LEFT OUTER JOIN "sap.tm.trp.routing.tests.db::t_trip_capacity_test" AS B
   ON A.trip_id = B.trip_id AND A.path_id = B.path_id AND A.from_sequence = B.from_sequence AND A.to_sequence = B.to_sequence;
END